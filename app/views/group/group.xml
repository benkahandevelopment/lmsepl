<Page xmlns:sd="nativescript-telerik-ui/sidedrawer"
    xmlns:shared="shared"
    loaded="loaded"
    actionBarHidden="true"
    xmlns:PullRefresh="nativescript-pulltorefresh">

    <!-- side drawer content -->
    <sd:RadSideDrawer id="sideDrawer">
        <sd:RadSideDrawer.drawerContent>
            <shared:drawer />
        </sd:RadSideDrawer.drawerContent>

        <!-- The main content -->
        <sd.RadSideDrawer.mainContent class="main-content-sd">
            <StackLayout orientation="vertical" verticalAlignment="top" horizontalAlignment="center">
                <GridLayout class="action-bar" columns="50,*,50" rows="auto,auto">
                    <Label row="0" col="0" class="action-icon-left fa" text="&#xf0c9;" tap="toggleDrawer"  />
                    <Label row="0" col="1" class="action-label" text="{{ teamName }}" />
                    <Label row="0" col="2" class="action-icon-right fa" text="&#xf013;" visibility="{{ isCaptain ? 'visible' : 'collapsed' }}" onTap="groupSettings" />
                    <Label row="1" colspan="3" class="action-meta" text="{{ teamDate }}" />
                </GridLayout>

                <PullRefresh:PullToRefresh refresh="refreshPage">
                    <ScrollView>
                        <StackLayout>
                            <Label class="group-msg msg-active" visibility="{{ active ? 'visible' : 'collapsed' }}" text="This group is currently active" />
                            <Label class="group-msg msg-inactive" visibility="{{ active ? 'collapsed' : 'visible' }}" text="This group is currently inactive" />

                            <GridLayout class="group-meta-active" columns="auto,*" rows="auto,auto,auto" visibility="{{ active ? 'visible' : 'collapsed' }}" ontap="teamSelect">
                                <Label row="0" col="0" text="Gameweek" class="group-meta-active-gw-label" />
                                <Label row="1" col="0" text="{{ gw }}" class="group-meta-active-gw-number" />
                                <Label row="0" col="1" colspan="2" text="Selection" class="group-meta-active-team-label" />
                                <Label row="1" col="1" text="{{ selectionName || '' }}" id="{{ selectionId || 0 }}" visibility="{{ selectionId ? 'visible' : 'collapsed'}}" class="group-meta-active-team-name" />
                                <Label row="1" col="2" text="Tap To Decide" visibility="{{ selectionId ? 'collapsed' : 'visible'}}" class="group-meta-active-team-decide" />
                                <ListView items="{{ clubArray }}" row="2" col="0" colspan="2" height="{{ clubHeight }}" class="list-clubs" itemTap="selectTeam" visibility="{{ clubSelect }}">
                                    <ListView.itemTemplate>
                                        <StackLayout orientation="horizontal" class="list-clubs-cont">
                                            <Label text="{{ name || 'Loading...' }}" textWrap="false" class="list-clubs-label" />
                                            <Label text="vs" textWrap="false" class="list-clubs-vs" />
                                            <Label text="{{ opp || 'Loading...' }}" textWrap="false" class="list-clubs-opp" />
                                        </StackLayout>
                                    </ListView.itemTemplate>
                                </ListView>
                            </GridLayout>

                            <GridLayout class="group-meta-inactive" columns="auto,*" rows="auto,auto" visibility="{{ active ? 'collapsed' : 'visible' }}">
                                <Label row="0" col="0" text="Gameweek" class="group-meta-inactive-gw-label" />
                                <Label row="1" col="0" text="{{ gw }}" class="group-meta-inactive-gw-number" />
                                <Label row="0" col="1" rowspan="2" text="League Inactive" class="group-meta-inactive-team-name" />
                            </GridLayout>

                            <GridLayout class="list-matches-toggle" columns="*,auto" rows="auto" ontap="toggleFixtures">
                                <Label class="list-matches-toggle-icon" col="0" row="0" text="&#xf078;" visibility="{{ fixturesToggle=='collapsed' ? 'visible' : 'collapsed' }}" />
                                <Label class="list-matches-toggle-icon" col="0" row="0" text="&#xf077;" visibility="{{ fixturesToggle=='collapsed' ? 'collapsed' : 'visible' }}" />
                                <Label class="list-matches-toggle-label" col="1" row="0" text="Toggle Fixtures" />
                            </GridLayout>
                            <ListView items="{{ matchArray }}" height="{{ matchHeight }}" visibility="{{ fixturesToggle }}" class="list-matches" itemTemplateSelector="ko ? 'ko' : 'match'">
                                <ListView.itemTemplates>
                                    <template key="match">
                                        <GridLayout columns="*,auto,auto,auto,*" rows="24" class="list-matches-item">
                                            <Label row="0" col="0" class="list-matches-item-label-home" text="{{ home || 'Loading...' }}" />
                                            <Label row="0" col="1" class="list-matches-item-label-homes" text="{{ homes }}" />
                                            <Label row="0" col="2" class="list-matches-item-label-vs" text="{{ homes && aways ? '-' : 'vs' }}" />
                                            <Label row="0" col="3" class="list-matches-item-label-aways" text="{{ aways }}" />
                                            <Label row="0" col="4" class="list-matches-item-label-away" text="{{ away || 'Loading...' }}" />
                                        </GridLayout>
                                    </template>
                                    <template key="ko">
                                        <GridLayout class="list-matches-ko" rows="30" columns="auto,*">
                                            <Label row="0" col="0" class="list-matches-ko-date" text="{{ koLabelDate }}" />
                                            <Label row="0" col="1" class="list-matches-ko-time" text="{{ koLabelTime }}" />
                                        </GridLayout>
                                    </template>
                                </ListView.itemTemplates>
                            </ListView>
                            <Label class="list-matches-toggle-baseline" text="" />

                            <StackLayout class="list-groups-animated">
                                <Label class="list-groups-title" text="Members" />
                                <ListView items="{{ groupArray }}" height="{{ groupsHeight }}" itemTap="groupTap">
                                    <ListView.itemTemplate>
                                        <GridLayout class="list-groups-item" columns="25,*,auto,auto" rows="41">
                                            <Image class="list-groups-item-icon" src="{{ icon }}" row="0" col="0" />
                                            <Label row="0" col="1" text="{{ name || 'Loading...' }}" textWrap="false" class="list-groups-label" />
                                            <Label row="0" col="2" text="{{ selectionName }}" visibility="{{ (selectionName && active) ? 'visible' : 'collapsed' }}" class="list-groups-selection-name" />
                                            <Label row="0" col="3" text="Undecided" visibility="{{ active ? (selectionName ? 'collapsed' : 'visible') : 'collapsed' }}" class="list-groups-selection-unchosen" />
                                        </GridLayout>
                                    </ListView.itemTemplate>
                                </ListView>
                            </StackLayout>
                            <Label class="admob-spacer" text="" />
                        </StackLayout>
                    </ScrollView>
                </PullRefresh:PullToRefresh>
            </StackLayout>
        </sd.RadSideDrawer.mainContent>
    </sd:RadSideDrawer>
</Page>
